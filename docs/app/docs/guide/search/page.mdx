import { Steps, Tabs } from 'nextra/components'

# 搜索引擎

Nextra 内置全页面搜索功能，让用户能够轻松在整个文档站点中查找相关内容。

> [!TIP]
>
> 更多信息请查阅
> [迁移指南](https://the-guild.dev/blog/nextra-4#new-search-engine--pagefind)

## 配置

Nextra 集成了 [Pagefind](https://pagefind.app) —— 一个静态搜索库，它能索引您的 HTML 文件并提供闪电般快速的客户端全文检索，整个过程无需服务器支持。

<Steps>
### 安装 `pagefind` 作为开发依赖

```sh npm2yarn
npm i -D pagefind
```

### 添加 `postbuild` 脚本

Pagefind 需要索引 `.html` 文件，因此索引操作必须在应用构建**完成后**执行。

在 `package.json` 中添加 `postbuild` 脚本：

<Tabs items={['服务端构建', '静态导出']}>
  <Tabs.Tab>
    ```json filename="package.json"
    "scripts": {
      "postbuild": "pagefind --site .next/server/app --output-path public/_pagefind"
    }
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```json filename="package.json"
    "scripts": {
      "postbuild": "pagefind --site .next/server/app --output-path out/_pagefind"
    }
    ```
  </Tabs.Tab>
</Tabs>

### 忽略生成文件

在 `.gitignore` 文件中添加 `_pagefind/` 以避免提交生成的索引文件。

### 验证索引输出

构建并运行 `postbuild` 脚本后，检查 `public/` 或 `out/` 目录下是否存在 `_pagefind/` 文件夹。启动应用并测试搜索栏以确认功能正常。

</Steps>

## 配置

搜索功能默认启用。如需完全禁用，可在 `next.config.mjs` 文件中设置：
`search: false{:js}`

```js filename="next.config.mjs" {4}
import nextra from 'nextra'

const withNextra = nextra({
  search: false
})
export default withNextra()
```

若需保留搜索功能但禁用代码块索引，可设置：
`search: { codeblocks: false }{:js}`:

```js filename="next.config.mjs" {4}
import nextra from 'nextra'

const withNextra = nextra({
  search: { codeblocks: false }
})
export default withNextra()
```